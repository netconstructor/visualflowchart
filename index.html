<!doctype html>
<html>
	<head>
		<title>Visual Flowchart Editor</title>
		<link href="libs/jquery-ui.css" rel="stylesheet"/>
		<link href="libs/elements.css" rel="stylesheet"/>
	<head>
	<body>
		<div class="demo statemachine-demo" id="statemachine-demo">
			<div class="w decide" id="opened" data-shape="Diamond">BEGIN
				<div class="ep"></div>
			</div>
			<div class="w decide" id="phone1">PHONE INTERVIEW 1
				<div class="ep"></div>
			</div>
			<div class="w" id="phone2">PHONE INTERVIEW 2
				<div class="ep"></div>
			</div>
			<div class="w" id="inperson">IN PERSON
				<div class="ep"></div>
			</div>
			<div class="w" id="rejected">REJECTED
				<div class="ep"></div>
			</div>
		</div>
	</body>
	<script src="libs/jquery-1.9.1.js"></script>
	<script src="libs/jquery-ui.js"></script>
	<script src="libs/jquery.jsPlumb-1.5.5-min.js"></script>
	<script>
		jsPlumb.ready(function () {
			// setup some defaults for jsPlumb.	
			var instance = jsPlumb.getInstance({
				Endpoint: ["Dot", {
					radius: 2
				}],
				HoverPaintStyle: {
					strokeStyle: "#1e8151",
					lineWidth: 2
				},
				ConnectionOverlays: [
					["PlainArrow", {
						location: 1,
						id: "arrow",
						length: 10,
						foldback: 0.5
					}],
					["Label", {
						label: "FOO",
						id: "label",
						cssClass: "aLabel"
					}]
				],
				Container: "statemachine-demo"
			});

			var windows = jsPlumb.getSelector(".statemachine-demo .w");

			// initialise draggable elements.  
			instance.draggable(windows);

			// bind a click listener to each connection; the connection is deleted. you could of course
			// just do this: jsPlumb.bind("click", jsPlumb.detach), but I wanted to make it clear what was
			// happening.
			instance.bind("click", function (c) {
				instance.detach(c);
			});

			// bind a connection listener. note that the parameter passed to this function contains more than
			// just the new connection - see the documentation for a full list of what is included in 'info'.
			// this listener sets the connection's internal
			// id as the label overlay's text.
			instance.bind("connection", function (info) {
				info.connection.getOverlay("label").setLabel(info.connection.id);
			});

			// suspend drawing and initialise.
			instance.doWhileSuspended(function () {

				// make each ".ep" div a source and give it some parameters to work with.  here we tell it
				// to use a Continuous anchor and the StateMachine connectors, and also we give it the
				// connector's paint style.  note that in this demo the strokeStyle is dynamically generated,
				// which prevents us from just setting a jsPlumb.Defaults.PaintStyle.  but that is what i
				// would recommend you do. Note also here that we use the 'filter' option to tell jsPlumb
				// which parts of the element should actually respond to a drag start.
				instance.makeSource(windows, {
					filter: ".ep", // only supported by jquery
					anchor: "Continuous",
					connector: ["StateMachine", {
						curviness: 20
					}],
					connectorStyle: {
						strokeStyle: "#5c96bc",
						lineWidth: 2,
						outlineColor: "transparent",
						outlineWidth: 2
					},
					maxConnections: 5,
					onMaxConnections: function (info, e) {
						alert("Maximum connections (" + info.maxConnections + ") reached");
					}
				});

				// initialise all '.w' elements as connection targets.
				instance.makeTarget(windows, {
					dropOptions: {
						hoverClass: "dragHover"
					},
					anchor: "Continuous"
				});

				// and finally, make a couple of connections
				instance.connect({
					source: "opened",
					target: "phone1"
				});
				instance.connect({
					source: "phone1",
					target: "inperson"
				});
				instance.connect({
					source: "phone1",
					target: "phone1"
				});
				instance.connect({
					source: "rejected",
					target: "phone2"
				});
			});

		});
	</script>
</html>